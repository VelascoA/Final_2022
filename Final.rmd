---
title: "Covid91 vaccine study Final2022"
author: "Alexis Velasco"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final_Data.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

# Males

```{r}
Males<-filter(FinalData,sex=="M")
```

## Graphic Results 

```{r}
dd2 <- Males %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
  
  The graphic results in the study for males show that the COVID 19 vaccine is working. About 65% of those who took the placebo vaccine got infected with COVID, where as about 30% who were vaccinated go the virus. However about 50 % who were vaccinated remained uninfected.  
  
## Numerical Results  
  
```{r}
table1 <- xtabs(~infected + treatment, data=Males)
rowPerc(table1)
colPerc(table1)
```
  The numerical results for males show 3% of those who had the placebo vaccine were infected with the virus and  only 1% who recived the COVID 19 vaccine caught the virus. 
  
## Inferential Results
```{r}
chisq.test(table1)
chisqtestGC(table1)
fishtestM<-fisher.test(table1)
fishtestM
```

The inferential results for males show us the odds ratio of 2 telling us that 2.09% of those who took the placebo are less likely to contract COVID 19. The p value being so small shows that the chances if there were no difference between males who received the placebo and who had gotten the vaccine.  
  
## Efficacy 

```{r}
options(digits = 1)
maleffic= fishtestM$estimate/(1+fishtestM$estimate)*100
malefficlo=fishtestM$conf.int[1]/(1+fishtestM$conf.int[1])*100
maleffichi=fishtestM$conf.int[2]/(1+fishtestM$conf.int[2])*100
print(maleffic)
print(malefficlo)
print(maleffichi)
```
  
  The study shows that the vaccine with males is 59% effective, the high confidence level of `r maleffichi` and the lowest confidence interval of `r malefficlo`. 
  
## Conclusion

The study is attempting to see how effective a COVID19 vaccination is, then breaking it down into different categories such as male. With males conducted in the study it can be see through the data the vaccination is highly effective. All sets of provided data support this statement. Graphical results conclude that 65% of those who took the placebo vaccine got infected with COVID, where as 30% who received the vaccine got the virus. The numerical results show 3% of those who had the placebo  were infected with the virus and 1% who received the COVID 19 vaccine caught the virus. Inferential results inform us of the odds ratio of 2 telling us that 2.09% of those who took the placebo are less likely to contract COVID 19. As well as the p value being so small shows that the chances if there were no difference between males who received the placebo and who had gotten the vaccine. Lastly the efficacy conclusion was the vaccination was 59% effective. With all these results the COVID 19 vaccine made is highly effective when it comes to males. 

# Females


```{r}
Females<-filter(FinalData,sex=="F")
```


## Grapical Results

```{r}
dd2 <- Females %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
Graphical results for females in the vaccination study, it shows that the COVID 19 vaccine is working. Almost 60%% of those who took the placebo vaccine got infected with COVID, where as a little over 40% who were vaccinated got the virus. However about 50 % who were vaccinated remained uninfected.  
  

## Numerical Results

```{r}
table2 <- xtabs(~infected + treatment, data=Females)
rowPerc(table2)
colPerc(table2)
```
  The numerical results for females show both groups, vaccinated and the placebo, in the study had 2% got infected with the COVID 19 virus. 


## Inferential Results 

```{r}
chisq.test(table2)
chisqtestGC(table2)
fishtestf<-fisher.test(table2)
fishtestf
```

 The odd ratio tells us that females who took the placebo are 1.43% less like to contract than those who received the vaccine.The p value shows if there were no difference between females who took placebo and the COVID 19 vaccine. 
 
## Efficacy  

```{r}
options(digits = 1)
femeffic= fishtestf$estimate/(1+fishtestf$estimate)*100
femefficlo=fishtestf$conf.int[1]/(1+fishtestf$conf.int[1])*100
femeffichi=fishtestf$conf.int[2]/(1+fishtestf$conf.int[2])*100
print(femeffic)
print(femefficlo)
print(femeffichi)
```

The study shows that the vaccine with females is 59% effective. With the high confidence level of `r femeffichi` and a low confidence level of `r femefficlo`.
 
  
## Conclusion


# LGBTQ

```{r}
LGBTQ<-filter(FinalData,LGBTQ=="gay")

```


## Graphical Results

```{r}
dd2 <- LGBTQ %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

Graphical results for the LGBTQ community show that the vaccine is not effective. It shows this by 80% of those who received the vaccine contracted the virus where around only 10% who took the placebo caught COVID 19. 

## Numerical Results

```{r}
table3 <- xtabs(~infected + treatment, data=LGBTQ)
rowPerc(table3)
colPerc(table3)
```

 The numerical results show 3% who got the vaccine still got COVID, were as .5% who took the placebo got COVID. More people who took the vaccine contracted virus that those who took the placebo.  

## Inferental Results

```{r}
chisq.test(table3)
chisqtestGC(table3)
fishtestG<-fisher.test(table3)
fishtestG
```


From the inferential results the fisher exact test gives odds ratio of .143, telling us that those who received the placebo  are .143 times more likely to contract the virus. The P value remaining so small shows how if there were to be no diffrence within the results. 

## Efficacy


```{r}
options(digits = 1)
Geffic= fishtestG$estimate/(1+fishtestG$estimate)*100
Gefficlo=fishtestG$conf.int[1]/(1+fishtestG$conf.int[1])*100
Geffichi=fishtestG$conf.int[2]/(1+fishtestG$conf.int[2])*100
print(Geffic)
print(Gefficlo)
print(Geffichi)
```
 The efficacy test shows the vaccine fir the LGBTQ community is 13% effective. Having the highest confidence levels of `r Geffichi` and the smallest confidence intervals of `r Gefficlo`. 

## Conclusion

# Druggies

```{r}
DrugUser<-filter(FinalData,DrugUser=="yes")

```

## Graphical Results 

```{r}
dd2 <- DrugUser %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

The graphical results for those who use drugs is ineffective. With 85% of those eho took the vaccinece still contracting COVID and only about 15% of those who took the placebo getting the vurus. Proving that that the vaccination is no good for drug users.


## Numerical Results
```{r}
table4 <- xtabs(~infected + treatment, data=DrugUser)
rowPerc(table4)
colPerc(table4)
```

The numerical results for the drug users in the study show 3% of those who received the vaccine contracted COVID where .6% of those with the placebo vaccination received COVID. 97% of those vaccinated with the vaccine remained okay but 99.4% of those who were given the placebo remained okay. Showing that the vaccine for drug users was ineffective. 

## Inferential Results 
```{r}
chisq.test(table4)
chisqtestGC(table4)
fishtestD<-fisher.test(table4)
fishtestD
```

The inferential results give us the odds ratio of .2 with and estimated .178 telling us that those who received the placebo  are .178 times more likely to contract the virus. The P value remaining so small shows how if there were to be no difference within the results. 

## Efficacy

```{r}
options(digits = 1)
Deffic= fishtestD$estimate/(1+fishtestD$estimate)*100
Defficlo=fishtestD$conf.int[1]/(1+fishtestD$conf.int[1])*100
Deffichi=fishtestD$conf.int[2]/(1+fishtestD$conf.int[2])*100
print(Deffic)
print(Defficlo)
print(Deffichi)
```
The efficacy test shows the vaccine fir the LGBTQ community is 15% effective. Having the highest confidence levels of `r Deffichi` and the smallest confidence intervals of `r Defficlo`. 

## Conclusion 





# Overall final Conclusion 
