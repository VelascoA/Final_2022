---
title: "Covid91 vaccine study Final2022"
author: "Alexis Velasco"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final_Data.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

# Males

```{r}
FinalDat<-read.csv(file="final_Data.csv")
```
```{r}
Males<-filter(FinalDat,sex=="M")
```
```{r}
Males<-select(Males, -sex)
```

## Graphic Results 

```{r}
dd2 <- Males %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
  
## Numerical results  
  
```{r}
table1 <- xtabs(~infected + treatment, data=Males)
rowPerc(table1)
colPerc(table1)
```
  
## Inferential results
```{r}
chisq.test(table1)
chisqtestGC(table1)
fishtestM<-fisher.test(table1)
```
  
## Efficacy 

```{r}
options(digits = 1)
femeffic= fishtestM$estimate/(1+fishtestM$estimate)*100
femefficlo=fishtestM$conf.int[1]/(1+fishtestM$conf.int[1])*100
femeffichi=fishtestM$conf.int[2]/(1+fishtestM$conf.int[2])*100
print(femeffic)
print(femefficlo)
print(femeffichi)
```
  
  
## Conclusion

# Females

```{r}
FinalDat<-read.csv(file="final_Data.csv")
```
```{r}
Females<-filter(FinalDat,sex=="F")
```
```{r}
Females<-select(Females, -sex)
```

## Grapical results

```{r}
dd2 <- Females %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```


## Numerical Results

```{r}
table2 <- xtabs(~infected + treatment, data=Females)
rowPerc(table2)
colPerc(table2)
```


## Inferential Results 

```{r}
chisq.test(table2)
chisqtestGC(table2)
fishtestf<-fisher.test(table2)
fishtestf
```

odd ratio tells us that those  who took P are 1.43% less like to contract than those who took vaccine, p value shows if there were no difference between females who took p and took V 
str(fishtestf) in console gives more info

## Efficacy  

```{r}
options(digits = 1)
femeffic= fishtestf$estimate/(1+fishtestf$estimate)*100
femefficlo=fishtestf$conf.int[1]/(1+fishtestf$conf.int[1])*100
femeffichi=fishtestf$conf.int[2]/(1+fishtestf$conf.int[2])*100
print(femeffic)
print(femefficlo)
print(femeffichi)
```

 
`r femefficlo`  `r femeffichi`

## Conclusion


# LGBTQ

```{r}
FinalDat<-read.csv(file="final_Data.csv")
```
```{r}
LGBTQ<-filter(FinalDat,LGBTQ=="gay")

```
```{r}
LGBTQ<-select(LGBTQ, -sex)
```


# Druggies

```{r}
FinalDat<-read.csv(file="final_Data.csv")
```
```{r}
DrugUser<-filter(FinalDat,DrugUser=="yes")

```
```{r}
DrugUser<-select(DrugUser, -sex)
```
